# 查找相近专色 v2.0 - 使用指南

## 📌 功能简介

**查找相近专色**工具可以从选中对象提取颜色，然后在 **4594 个专色** 中自动查找最相近的专色并应用。

### ✨ v2.0 新增功能

1. ✅ **描边和填充分开查找** - 精确指定要查找哪个颜色
2. ✅ **应用前实时预览** - 先看效果再决定
3. ✅ **自动创建真专色色板** - 直接应用Spot Color，不是RGB
4. ✅ **列表显示色块** - 直观对比颜色差异

支持的专色库：
- **PANTONE**（彩通）：2390 色
- **RAL CLASSIC**（劳尔经典）：216 色
- **RAL Design**（劳尔设计）：未统计
- **NIPPON**（立邦）：1988 色

## 🎯 适用场景

1. **印刷准备**：将设计稿中的RGB颜色转换为专色
2. **品牌配色**：查找最接近品牌色的标准专色
3. **色卡匹配**：根据客户提供的颜色找到对应的色号
4. **颜色标准化**：统一使用标准专色，避免色差
5. **描边专色转换**：单独处理描边颜色

## 🚀 使用步骤

### 步骤1：选择对象

在 Illustrator 中选择**至少一个**包含颜色的对象。

支持的颜色类型：
- ✅ 填充色
- ✅ 描边色
- ✅ RGB / CMYK / 灰度 / 专色

### 步骤2：运行工具

在 HOPE 工具箱面板中：
- 切换到 **🖼️ 图像处理** 分类
- 点击 **查找相近专色** 按钮

### 步骤3：选择颜色类型（新功能！）

**如果对象同时有填充和描边**，会弹出对话框让你选择：

```
┌─────────────────────────────────┐
│  选择要查找的颜色                │
│                                 │
│  选中对象同时包含填充和描边颜色， │
│  请选择要查找哪一个：            │
│                                 │
│  ○ 查找填充色   (默认选中)       │
│  ○ 查找描边色                   │
│                                 │
│     [确定]    [取消]             │
└─────────────────────────────────┘
```

**智能判断**：
- 只有填充色 → 自动查找填充
- 只有描边色 → 自动查找描边
- 两者都有 → 弹出选择对话框

### 步骤4：查看结果（带色块显示！）

```
┌──────────────────────────────────────────────────────┐
│  查找相近专色 - 结果                                   │
├──────────────────────────────────────────────────────┤
│  当前颜色（填充）                                      │
│  ■ RGB: 246, 235, 97                                 │
│  ↑ 色块预览                                           │
├──────────────────────────────────────────────────────┤
│  最接近的专色（共10个）                                │
│                                                      │
│  ■ │ PANTONE    │ PANTONE 100 C │ Color 100 C │ 98% │
│  ■ │ PANTONE    │ PANTONE 101 C │ Color 101 C │ 96% │
│  ■ │ RAL_CLASSIC│ RAL 1016      │ 硫磺黄      │ 89% │
│  ■ │ NIPPON     │ BA0123-2      │ 柠檬黄      │ 85% │
│  ↑ 每行都有色块，点击可选中                            │
├──────────────────────────────────────────────────────┤
│  预览                                                 │
│  色库：PANTONE                                        │
│  色号：PANTONE 100 C                                  │
│  色名：Color 100 C                                    │
│  RGB：246, 235, 97                                    │
│  CMYK：C0 M4 Y61 K4                                  │
│  HEX：#F6EB61                                        │
│                                                      │
│  [应用预览到选中对象] ← 新功能：先预览！               │
├──────────────────────────────────────────────────────┤
│         [确定应用]    [取消]                          │
└──────────────────────────────────────────────────────┘
```

列表说明：
- **色块**：左侧显示专色的实际颜色
- **色库**：专色来源（PANTONE/RAL/NIPPON）
- **色号**：标准色号（如 PANTONE 100 C）
- **色名**：颜色名称
- **相似度**：100%表示完全匹配

### 步骤5：预览效果（新功能！）

1. **在列表中点击某个专色** → 选中该行（高亮显示）
2. **点击"应用预览到选中对象"按钮** → 立即看到效果
3. **不满意？** → 点击其他专色继续预览
4. **满意？** → 点击"确定应用"

**预览特点**：
- 实时应用到画板上的对象
- 可以反复切换不同专色预览
- 不点"确定应用"就不会创建专色色板

### 步骤6：应用专色（新功能！）

点击"确定应用"后：

1. ✅ **自动创建专色色板**（如果不存在）
2. ✅ **应用真正的 Spot Color**（不是RGB）
3. ✅ **使用CMYK值**（适合印刷）
4. ✅ **色板面板中可见**（可直接使用）

**提示信息**：
```
已应用专色：

PANTONE 100 C
Color 100 C

专色已添加到色板面板。
```

### 步骤7：检查色板

打开 **窗口 > 色板**，你会看到：
- 新创建的专色（如 PANTONE 100 C）
- 类型标记为 **Spot Color**
- CMYK 值已设置好

## 🎨 工作流程示例

### 场景1：品牌色转专色

1. 画一个品牌色矩形（如 RGB 246,235,97）
2. 运行工具 → 自动查找填充色
3. 列表显示 10 个最接近的专色（带色块）
4. 点击第一个（PANTONE 100 C，98%）
5. 点击"应用预览" → 看效果
6. 满意 → 点"确定应用"
7. 专色已应用，色板中已添加 ✅

### 场景2：描边单独转专色

1. 对象有红色填充 + 蓝色描边
2. 运行工具 → 选择"查找描边色"
3. 列表显示蓝色系专色
4. 预览 + 应用
5. **描边**变成专色，**填充**保持不变 ✅

### 场景3：批量应用同一专色

1. 第一个对象：查找并应用专色
2. 其他对象：
   - 方法A：直接从色板拖拽专色
   - 方法B：再次运行工具，会复用已有专色

## 💡 高级技巧

### 技巧1：专色复用

如果专色已存在于色板中：
- 工具会**复用**已有专色，不会重复创建
- 确保文档中专色统一

### 技巧2：色块对比

列表中的色块帮你快速判断：
- 亮度差异
- 色相差异
- 饱和度差异

**不用只看相似度百分比**，直接看色块更直观！

### 技巧3：多次预览

可以反复点击不同专色预览：
1. 点第1个 → 预览
2. 点第3个 → 预览
3. 点第2个 → 预览
4. 满意某个 → 确定应用

### 技巧4：取消预览

如果预览后不满意：
- 点"取消"按钮 → 颜色恢复到运行脚本前的状态

### 技巧5：CMYK印刷优化

应用的专色使用JSON中的CMYK值：
- 适合印刷输出
- 与色库标准一致
- 印刷厂可直接使用

## ⚠️ 注意事项

### 1. 颜色模式转换

- **RGB → 专色**：最准确
- **CMYK → 专色**：需转RGB中转，有轻微色差
- **专色 → 专色**：可查找相似的其他专色

### 2. 预览 vs 最终应用

- **预览**：临时应用RGB颜色（快速）
- **确定应用**：创建真专色色板（专业）

### 3. 专色命名

专色色板使用色号命名：
- `PANTONE 100 C`
- `RAL 1016`
- `NIPPON 立邦 BA0001-1`

### 4. 色板管理

- 重复运行不会创建重复专色
- 可在色板面板中删除不需要的专色
- 专色可应用到其他对象

### 5. 性能

- 首次运行加载4594个专色：约2-3秒
- 后续运行：<1秒
- 色块渲染：实时

## 🐛 常见问题

**Q1: 为什么没有弹出"选择颜色类型"对话框？**

A: 只有当对象**同时有填充和描边**时才会弹出。如果只有一个，会自动选择。

**Q2: 预览和最终应用有什么区别？**

A:
- **预览**：临时应用RGB颜色，方便快速查看
- **确定应用**：创建真专色色板并应用，用于印刷

**Q3: 点了"应用预览"后，又换了其他专色预览，之前的预览会丢失吗？**

A: 不会！每次点"应用预览"都会覆盖上一次，可以反复切换。

**Q4: 色块显示不准确？**

A: 色块使用RGB值渲染，可能与印刷CMYK有差异。以CMYK值为准。

**Q5: 如何删除不需要的专色？**

A: 打开色板面板 → 选中专色 → 点删除按钮（或拖到垃圾桶）

**Q6: 相似度100%是什么意思？**

A: RGB完全匹配。但注意：RGB相同不代表CMYK相同。

**Q7: 能否只搜索PANTONE色库？**

A: 当前版本搜索所有色库。结果列表会显示色库名称，手动筛选即可。

**Q8: 专色应用后能修改吗？**

A: 可以！在色板面板中双击专色，修改CMYK值或名称。

## 📊 功能对比

| 功能 | v1.0 | v2.0（当前） |
|------|------|-------------|
| 提取颜色 | 填充优先，其次描边 | **分开选择** ✨ |
| 列表显示 | 纯文本 | **带色块** ✨ |
| 预览功能 | ❌ 无 | **实时预览** ✨ |
| 应用颜色 | RGB颜色 | **真专色色板** ✨ |
| 色板添加 | ❌ 不添加 | **自动添加** ✨ |
| 专色复用 | ❌ 不支持 | **自动检测** ✨ |

## 🔮 后续可能的升级

如果需要更专业的功能：

1. **色库筛选** - 只搜索PANTONE或RAL
2. **Delta E (LAB)算法** - 更精确的色差
3. **批量转换** - 一键转换所有对象
4. **色差阈值** - 只显示相似度>90%的
5. **导出专色列表** - 生成印刷用色卡
6. **自定义专色库** - 添加自己的色库

---

## 📝 总结

v2.0 的改进让工具更**专业**、更**实用**：

✅ **描边/填充分开** - 精确控制
✅ **色块显示** - 直观对比
✅ **实时预览** - 先看效果
✅ **真专色色板** - 印刷就绪

现在这是一个**印刷级**的专色查找工具！

---

**技术支持**：如有问题，请查看浏览器控制台日志或联系开发团队。
